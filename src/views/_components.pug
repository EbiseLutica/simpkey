
mixin avatar(user)
    img.avatar(src=user.avatarUrl, alt="avatar for " + user.username style="width: 64px; height: 64px; border-radius: 50%")&attributes(attributes)

mixin note-header(note)
    header&attributes(attributes)
        a(href="/" + getAcct(note.user))
            span.name= getUserName(note.user)
            span.acct(style="color: gray")= getAcct(note.user)
        if note.user.isAdmin
            span.bot [ADMIN]
        else if note.user.isModerator
            span.bot [MOD]
        if note.user.isBot
            span.bot [BOT]
        if note.user.isCat
            span.bot [CAT]        

mixin sub-note(note)
    .sub-note
        +avatar(note.user)                  
        +note-header(note)
        p
            if note.cw
                details
                    summary !{note.cw} (!{note.text.length}æ–‡å­—)
                    != note.text
            else
                != note.text
        aside
            span.visibility= getVisibility(note)
            a.date(href="/notes/" + note.id)= new Date(note.createdAt).toLocaleString()

mixin note(note)
    if note.reply
        +sub-note(note.reply)(style="opacity: 0.5")
    if note.renote && !note.text
        p: b ğŸ” !{getUserName(note.user)} ãŒRenote
        +note(note.renote)
    else
        .note&attributes(attributes)
            +avatar(note.user)
            +note-header(note)
            p
                if note.reply
                    | â†©
                if note.cw
                    details
                        summary !{note.cw} (!{note.text.length}æ–‡å­—)
                        != note.text
                else
                    != note.text
            if note.renote
                p RN:
                +sub-note(note.renote)
            aside
                span.visibility= getVisibility(note)
                a.date(href="/notes/" + note.id)= new Date(note.createdAt).toLocaleString()
            .reactions
                each val, key in note.reactions
                    span(class=(key === note.myReaction ? 'my reaction' : 'reaction'))=`${key} ${val}`
            footer
                |[
                a(href="/reply/" + note.id) ï¾˜ï¾Œï¾Ÿï¾—ï½² !{note.repliesCount}
                |]
                if canRenote && canRenote(note)
                    |[
                    a(href="/renote/" + note.id) ï¾˜ï¾‰ï½°ï¾„ !{note.renoteCount}
                    |]
                if canReact && canReact(note)
                    if !note.myReaction
                        | [
                        a(href="/react/" + note.id) ï¾˜ï½±ï½¸ï½¼ï½®ï¾
                        | ]
                    else
                        form(action="action/unreact", method="post" style="display: inline")
                            input(type="hidden", name="noteId", value=note.id)
                            button(type="submit") ï¾˜ï½±ï½¸ï½¼ï½®ï¾è§£é™¤

mixin post-form(url, placeholder, buttonText)
    form(action=url, method="post")
        div: label
            input(type="checkbox", name="useCw")
            span CW
        input(type="text", name="cw" placeholder="æ³¨é‡ˆ(çœç•¥å¯èƒ½)" style="max-width: 100%; min-width: 100%;")
        textarea(name="text", placeholder=placeholder style="max-width: 100%; min-width: 100%; height: 6em; margin-bottom: 8px")
        button(type="submit")= buttonText
        block

mixin nav()
    div
        |[
        a(href="/") ãƒ›ãƒ¼ãƒ 
        |] [
        a(href="/ltl") ãƒ­ãƒ¼ã‚«ãƒ«
        |] [
        a(href="/stl") ã‚½ãƒ¼ã‚·ãƒ£ãƒ«
        |] [
        a(href="/gtl") ã‚°ãƒ­ãƒ¼ãƒãƒ«
        |] [
        a(href="/notifications") é€šçŸ¥
        |] [
        a(href="/settings") è¨­å®š
        |]

mixin user-header(user, detail = false)
    if detail
        if user.host
            .remote-caution âš  ãƒªãƒ¢ãƒ¼ãƒˆã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã¤ãã€æƒ…å ±ãŒæ­£ç¢ºã§ã¯ç„¡ã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
                a(href=user.url || user.uri, target="_blank", rel="noopener noreferrer") ãƒªãƒ¢ãƒ¼ãƒˆã§ç¢ºèªã™ã‚‹
        if user.isSuspended
            .suspended âš  ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯å‡çµã•ã‚Œã¦ã„ã¾ã™
        if user.isSilenced
            .silenced âš  ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ã‚µã‚¤ãƒ¬ãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™
    +avatar(user)
    .name: b=getUserName(user)
        | &nbsp;
        span(style="color: gray")= getAcct(user)
        if user.isFollowed
            span.is-followed ãƒ•ã‚©ãƒ­ãƒ¼ã•ã‚Œã¦ã„ã¾ã™

        if user.isLocked
            span.lock
        if user.isAdmin
            span.bot [ADMIN]
        else if user.isModerator
            span.bot [MOD]
        if user.isBot
            span.bot [BOT]
        if user.isCat
            span.bot [CAT]
    if detail
        if user.description
            .description= user.description
        if user.birthday
            .birthday ğŸ‚ !{user.birthday}
        if user.location
            .birthday ğŸ“!{user.location}
        if user.sex
            .sex æ€§åˆ¥: !{user.sex}
        if user.sex
            .sex æ€§åˆ¥: !{user.sex}
        dl
            each field in user.fields
                dt= field.name
                dd= field.value
                
    .count
        a.notes(href="/" + getAcct(user)) !{user.notesCount} ãƒãƒ¼ãƒˆ
        |  
        //- a.following(href="/" + getAcct(user) + "/following") 
        | !{user.followingCount} ãƒ•ã‚©ãƒ­ãƒ¼
        |  
        //- a.followers(href="/" + getAcct(user) + "/followers")
        | !{user.followersCount} ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼

mixin timeline(notes)
    each note in notes
        hr
        +note(note)